<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Diesel Plant Simulation</title>
  <style>
    body {
  font-family: Arial, sans-serif;
  background-image: url('../source/BackgroundMap.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  margin: 0;
  padding: 0;
}


    header {
      background-color: #003366;
      color: white;
      padding: 20px;
      text-align: center;
    }

    .container {
      position: relative;
      width: 1920px;
      height: 1080px;
      margin: 0 auto;
      padding: 20px;
      overflow: hidden;
    }

    .card {
      position: absolute;
      width: 160px;
      height: 160px;
      background-color: white;
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      cursor: pointer;
      z-index: 2;
      transition: box-shadow 0.5s ease;
    }

    .card.glow-green { box-shadow: 0 0 20px 5px #00ff00; }
    .card.glow-red { box-shadow: 0 0 20px 5px #ff0000; }
    .card.glow-blue { box-shadow: 0 0 20px 5px #00ccff; }
    .card.glow-yellow { box-shadow: 0 0 20px 5px #ffff00; }

    .card h3 {
      margin: 0;
      padding: 0;
      font-size: 16px;
      z-index: 9999;
    }

    #local-demand {
  top: 500px;
  left: 1750px;
  width: 160px;
  height: 160px;
}

#inland-demand {
  top: 700px;
  left: 1200px;
  width: 160px;
  height: 160px;
}

#local-demand + .card-label {
  top: 670px;
  left: 1750px;
  background: rgba(0, 0, 0, 0.7);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
}

#inland-demand + .card-label {
  top: 870px;
  left: 1200px;
  background: rgba(0, 0, 0, 0.7);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
}

.spinner-container {
      position: absolute;
      font-size: 14px;
    }

    input[type="text"] {
      width: 160px;
      height: 30px;
      font-size: 14px;
      text-align: center;
      margin-right: 5px;
    }

    .buttons {
      display: inline-block;
      vertical-align: top;
    }

    .buttons button {
      height: 16px;
      width: 20px;
      display: block;
      padding: 0;
    }

    /* Positioning each spinner */
    #spinner1 { top: 400px; left: 50px; }
    #spinner2 { top: 60px; left: 760px; }
    #spinner3 { top: 190px; left: 50px; }
    #spinner4 { top: 50px; left: 300px; }
    #spinner5 { top: 120px; left: 300px; }
    #spinner6 { top: 190px; left: 300px; }

    .pipe {
      position: absolute;
      height: 15px;
      background: repeating-linear-gradient(
        90deg,
        #007bff,
        #007bff 10px,
        #00c6ff 10px,
        #00c6ff 20px
      );
      background-size: 40px 6px;
      animation: flow 1.2s linear infinite;
      border-radius: 4px;
      z-index: 1;
    }

    @keyframes flow {
      0% { background-position: 0 0; }
      100% { background-position: 40px 0; }
    }

    .flow-label {
      position: absolute;
      background-color: #fff;
      padding: 3px 8px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 12px;
      white-space: nowrap;
      z-index: 3;
    }

    /* Cards */
    #refinery         { top: 20px; left: 20px; width: 300px; height: 300px ; }
    #terminal         { top: 200px; left: 700px; width: 300px; height: 300px; }
    #local-storage  { top: 100px; left: 1500px; width: 200px; height: 200px ;}
    #inland-storage   { top: 700px; left: 700px; width: 250px; height: 250px ;}
    
    #status           {
      top: 1000px;
      left: center;
      border-radius: 20px;
      width: 1800px;
      height: auto;
      padding: 20px;
    }

    .card img {
      width: 70%;
      height: auto;
      object-fit: cover;
      position: relative;
      z-index: 1;
      display: block;
      margin: 0 auto;
    }

    .percentage-overlay {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 4px 8px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      font-size: 14px;
      border-radius: 4px;
      z-index: 2;
      pointer-events: none;
    }

    /* Pipes */
    #pipe1 {
      top: 250px; left: 230px;
      width: 500px;
      transform: rotate(25deg);
      
      
    }

    #pipe2 {
      top: 300px; left: 820px;
      width: 700px;
      transform: rotate(-15deg);
    }

    #pipe3 {
      top: 450px;
      left: 820px;
      width: 15px;
      height: 270px;
      transform: rotate(0deg);
    }

    #pipe4 {
  top: 240px;
  left: 1700px;
  width: 15px;
  height: 300px;
  transform: rotate(-30deg);
}

#pipe5 {
  top: 800px;
  left: 900px;
  width: 310px;
  height: 15px;
  transform: rotate(-10deg);
}
    .pipe {
  animation-duration: var(--flow-speed, 1.2s);
}



    /* Flow labels */
    #label1 { top: 200px; left: 500px; }
    #label2 { top: 210px; left: 1200px; }
    #label3 { top: 600px; left: 810px; }
    #label4 {top: 410px; left: 1670px; }
    #label5 {top: 770px; left: 1010px; }



    .card-label {
      position: absolute;
      width: 160px;
      text-align: center;
      left: 0;
      font-size: 16px;
      margin: 0;
      padding: 0;
      pointer-events: none;
    }
    #refinery + .card-label { top: 350px; left: 80px; padding: 4px 8px; background: rgba(0, 0, 0, 0.7); color: white; border-radius: 4px; }
    #terminal + .card-label { top: 150px; left: 750px; width: 200px; padding: 4px 8px; background: rgba(0, 0, 0, 0.7); color: white; border-radius: 4px; }
    #local-storage + .card-label { top: 60px; left: 1500px; z-index: 11; padding: 4px 8px; background: rgba(0, 0, 0, 0.7); color: white; border-radius: 4px; }
    #inland-storage + .card-label { top: 960px; left: 730px; padding: 4px 8px; background: rgba(0, 0, 0, 0.7);color: white; border-radius: 4px; }

    
  </style>
</head>
<body>
  <header>
    <h1>ðŸš› Diesel Plant Simulation</h1>
  </header>

  <div class="container">
    <!-- Plant Cards -->
    <div class="card" id="refinery"><img src ="..\source\RefinerySimple.jpg" alt = "RefinerySimple Image"></div>
    <div class="card-label">Refinery</div>
    <div class="card" id="terminal" onclick="openModal('Terminal')"><img src ="..\source\OilTankSimple.jpg" alt = "Oil Tank Image Image"><span class="percentage-overlay">75%</span></div>
    <div class="card-label">Terminal</div>
    <div class="card" id="local-storage" onclick="openModal('Local Storage')"><img src ="..\source\OilTankSimple.jpg" alt = "Oil Barrel Image"><span class="percentage-overlay">75%</span></div>
    <div class="card-label">Local Storage</div>
    <div class="card" id="inland-storage" onclick="openModal('Inland Storage')"><img src ="..\source\OilTankSimple.jpg" alt = "Oil Barrel Image"><span class="percentage-overlay">75%</span></div>
    <div class="card-label">Inland Storage</div>
    <div class="card" id="status"><h3>Status</h3><p>Monitoring...</p></div>
    <div class="card" id="local-demand" onclick="openModal('Local Demand')"><img src ="..\source\OtherOilPump.jpg" alt="Local Demand Image"><span class="percentage-overlay">80%</span></div>
    <div class="card-label">Local Demand</div>
    <div class="card" id="inland-demand" onclick="openModal('Inland Demand')"><img src ="..\source\OilPump.png" alt="Inland Demand Image"><span class="percentage-overlay">65%</span></div>
    <div class="card-label">Inland Demand</div>




<!-- Spinner template -->
  <div id="spinner1" class="spinner-container">
    <label>Product Rate:</label><br>
    <input type="text" id="text1" readonly>
    <div class="buttons">
      <button onclick="scrollUp(0)">â–²</button>
      <button onclick="scrollDown(0)">â–¼</button>
    </div>
  </div>

  <div id="spinner2" class="spinner-container">
    <label>Storage Capacity:</label><br>
    <input type="text" id="text2" readonly>
    <div class="buttons">
      <button onclick="scrollUp(1)">â–²</button>
      <button onclick="scrollDown(1)">â–¼</button>
    </div>
  </div>

  <div id="spinner3" class="spinner-container">
    <label>Storage Capacity:</label><br>
    <input type="text" id="text3" readonly>
    <div class="buttons">
      <button onclick="scrollUp(2)">â–²</button>
      <button onclick="scrollDown(2)">â–¼</button>
    </div>
  </div>

  <div id="spinner4" class="spinner-container">
    <label>Storage Capacity:</label><br>
    <input type="text" id="text4" readonly>
    <div class="buttons">
      <button onclick="scrollUp(3)">â–²</button>
      <button onclick="scrollDown(3)">â–¼</button>
    </div>
  </div>

  <div id="spinner5" class="spinner-container">
    <label>Demand Rate:</label><br>
    <input type="text" id="text5" readonly>
    <div class="buttons">
      <button onclick="scrollUp(4)">â–²</button>
      <button onclick="scrollDown(4)">â–¼</button>
    </div>
  </div>

  <div id="spinner6" class="spinner-container">
    <label>Demand Rate:</label><br>
    <input type="text" id="text6" readonly>
    <div class="buttons">
      <button onclick="scrollUp(5)">â–²</button>
      <button onclick="scrollDown(5)">â–¼</button>
    </div>
  </div>

    <!-- Pipes -->
    <div class="pipe" id="pipe1"></div> 
    <div class="pipe" id="pipe2"></div> 
    <div class="pipe" id="pipe3"></div> 
    <div class="pipe" id="pipe4"></div>
    <div class="pipe" id="pipe4"></div> 
    <div class="pipe" id="pipe5"></div> 

    <!-- Flow Labels -->
    <div class="flow-label" id="label1">Flow: 60%</div>
    <div class="flow-label" id="label2">Flow: 50%</div>
    <div class="flow-label" id="label3">Flow: 70%</div>
    <div class="flow-label" id="label4">Flow: 80%</div>
    <div class="flow-label" id="label5">Flow: 65%</div>

  </div>

  

  <script>


const options = [
      ["Shutdown", "Operational"], // Spinner 1
      ["20%", "40%", "60%", "80%", "100%"],        // Spinner 2
      ["20%", "40%", "60%", "80%", "100%"],            // Spinner 3
      ["20%", "40%", "60%", "80%", "100%"],             // Spinner 4
      ["Low", "Medium", "High"], // Spinner 5
      ["Low", "Medium", "High"]  // Spinner 6
    ];

    const indices = [0, 0, 0, 0, 0, 0];

    function updateDisplay(i) {
      document.getElementById('text' + (i + 1)).value = options[i][indices[i]];
    }

    function scrollUp(i) {
      indices[i] = (indices[i] - 1 + options[i].length) % options[i].length;
      updateDisplay(i);
    }

    function scrollDown(i) {
      indices[i] = (indices[i] + 1) % options[i].length;
      updateDisplay(i);
    }

    // Initialize all spinners on page load
    window.onload = () => {
      for (let i = 0; i < options.length; i++) {
        updateDisplay(i);
      }
    };

//    const options = {
//      "Refinery": ["Shutdown", "Operational"],
//      "Terminal": ["0 tanks out", "1 tanks out","2 tanks out", "3 tanks out", "4 tanks out"],
//      "Local Storage": ["None", "Full"],
//      "Inland Storage": ["0 tanks out", "1 tanks out","2 tanks out", "3 tanks out"]
//    };

    const cardGlowMap = {
      "Refinery": ["glow-red", "glow-green"],
      "Terminal": ["glow-yellow", "glow-blue"],
      "Local Storage": ["glow-red", "glow-green"],
      "Inland Storage": ["glow-blue", "glow-green"]
    };

    function applySelection() {
      const selected = modalSelect.value;
      if (selected) {
        const card = document.getElementById(currentCard.toLowerCase().replace(" ", "-"));
        card.classList.remove("glow-red", "glow-green", "glow-blue", "glow-yellow");

        if (selected.includes("Operational") || selected.includes("Full") || selected.includes("High")) {
          card.classList.add(cardGlowMap[currentCard][1]);
        } else {
          card.classList.add(cardGlowMap[currentCard][0]);
        }

        alert(`${currentCard}, set to: ${selected}`);
        modal.style.display = "none";
      } else {
        alert("Please select an option.");
      }
    }

    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    };

    options["Local Demand"] = ["Low", "Medium", "High"];
    options["Inland Demand"] = ["Low", "Medium", "High"];


cardGlowMap["Local Demand"] = ["glow-yellow", "glow-green"];
cardGlowMap["Inland Demand"] = ["glow-yellow", "glow-green"];


    // Simulated flow updates
function updateFlowLabels() {
  const maxFlowRate = 100; // You can customize this value per pipe if needed

  const percent1 = 40 + Math.floor(Math.random() * 40); // 40â€“79%
  const percent2 = 30 + Math.floor(Math.random() * 50); // 30â€“79%
  const percent3 = 50 + Math.floor(Math.random() * 30); // 50â€“79%
  const percent4 = 50 + Math.floor(Math.random() * 30);
  const percent5 = 50 + Math.floor(Math.random() * 30);

  const flow1 = ((percent1 / 100) * maxFlowRate).toFixed(1);
  const flow2 = ((percent2 / 100) * maxFlowRate).toFixed(1);
  const flow3 = ((percent3 / 100) * maxFlowRate).toFixed(1);
  const flow4 = ((percent4 / 100) * maxFlowRate).toFixed(1);
  const flow5 = ((percent5 / 100) * maxFlowRate).toFixed(1);

  document.getElementById("label1").textContent = `Flow: ${flow1} kL/h`;
  document.getElementById("label2").textContent = `Flow: ${flow2} kL/h`;
  document.getElementById("label3").textContent = `Flow: ${flow3} kL/h`;
  document.getElementById("label4").textContent = `Flow: ${flow4} kL/h`;
  document.getElementById("label5").textContent = `Flow: ${flow5} kL/h`;
}

setInterval(updateFlowLabels, 2000);


function setFlowSpeed(pipeId, labelId, percent) {
  const pipe = document.getElementById(pipeId);
  const label = document.getElementById(labelId);

  // Normalize speed (higher percentage = faster flow)
  const minDuration = 0.5;
  const maxDuration = 2.5;
  const duration = maxDuration - (percent / 100) * (maxDuration - minDuration);
  pipe.style.setProperty('--flow-speed', `${duration}s`);

  // Convert percentage to flow rate (in kiloliters per hour)
  const maxFlowRate = 100; // Max flow rate in kL/h
  const flowRate = ((percent / 100) * maxFlowRate).toFixed(1); // round to 1 decimal

  // Update label with kL/h instead of percentage
  label.innerText = `Flow: ${flowRate} kL/h`;
}

// Set initial flow speeds
setFlowSpeed("pipe1", "label1", 60);
setFlowSpeed("pipe2", "label2", 50);
setFlowSpeed("pipe3", "label3", 70);
setFlowSpeed("pipe4", "label4", 80); 
setFlowSpeed("pipe5", "label5", 65);

  </script>
</body>
</html>