<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Diesel Plant Simulation</title>
  <style>
    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-image: url('../source/Map2 .png');
      background-size: 100;
      background-position: center;
      background-repeat: no-repeat;
      font-size: 18px;
      font-weight: bold;
    }

    header {
      background-color: #003366;
      color: white;
      padding: 20px;
      text-align: center;
    }

    h1, h2, h3, h4, h5, h6 {
      font-size: revert;
      font-weight: revert;
    }

    .container {
      position: relative;
      width: 100%;
      height: 100%;
      margin: 0 auto;
      padding: 20px;
      overflow: hidden;
      transform-origin: top left;
      transform: scale(1);
    }

    @media (max-width: 100%) {
      .container {
        transform: scale(calc(100vw / 1920));
      }
    }

    .card {
      position: absolute;
      background-color: white;
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      cursor: pointer;
      z-index: 2;
      transition: box-shadow 0.5s ease;
      font-size: 18px;
      font-weight: bold;
    }

    .card.glow-green { box-shadow: 0 0 20px 5px #00ff00; }
    .card.glow-red { box-shadow: 0 0 20px 5px #ff0000; }
    .card.glow-blue { box-shadow: 0 0 20px 5px #00ccff; }
    .card.glow-yellow { box-shadow: 0 0 20px 5px #ffff00; }

    .card img {
      width: 70%;
      height: auto;
      object-fit: cover;
      position: relative;
      z-index: 1;
      display: block;
      margin: 0 auto;
    }

    .percentage-overlay {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 4px 8px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      font-size: 18px;
      border-radius: 4px;
      z-index: 2;
      pointer-events: none;
    }

    .card-label {
      position: absolute;
      width: 160px;
      text-align: center;
      font-size: 18px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border-radius: 4px;
      padding: 4px 8px;
    }

    #refinery { top: 600px; left: 470px; width: 130px; height: 130px; }
    #terminal { top:550px; left: 830px; width: 140px; height: 140px; }
    #local-storage { top: 335px; left: 1150px; width: 100px; height: 100px; }
    #inland-storage { top: 100px; left: 950px; width: 100px; height: 100px; }
    #local-demand { top: 250px; left: 1250px; width: 70px; height: 70px; }
    #inland-demand { top: 200px; left: 850px; width: 70px; height: 70px; }
    #status {
      top: 2400px;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 20px;
      width: 1800px;
      height: auto;
      padding: 20px;
    }

    #refinery + .card-label { top: 570px; left: 450px; }
    #terminal + .card-label { top: 550px; left: 770px; width: 110px; transform: rotate(-40deg); }
    #local-storage + .card-label { top: 335px; left: 1050px; transform: rotate(-50deg); }
    #inland-storage + .card-label { top: 960px; left: 730px; }
    #local-demand + .card-label { top: 670px; left: 1750px; }
    #inland-demand + .card-label { top: 870px; left: 1200px; }

    .pipe {
      position: absolute;
      height: 15px;
      background: repeating-linear-gradient(90deg, #007bff, #007bff 10px, #00c6ff 10px, #00c6ff 30px);
      background-size: 40px 6px;
      animation: flow var(--flow-speed, 1.2s) linear infinite;
      border-radius: 4px;
      z-index: 1;
    }

    @keyframes flow {
      0% { background-position: 0 0; }
      100% { background-position: 40px 0; }
    }

    #pipe1 { top: 650px; left: 500px; width: 350px; transform: rotate(-10deg); }
    #pipe2 { top: 400px; left: 740px; width: 430px; transform: rotate(100deg); }
    #pipe3 { top: 180px; left: 900px; width: 100px; transform: rotate(140deg); }
    #pipe4 { top: 300px; left: 1200px; width: 100px; transform: rotate(130deg); }
    #pipe5 { top: 500px; left: 900px; width: 310px; height: 15px; transform: rotate(-40deg); }

    .flow-label {
      position: absolute;
      background-color: #7bb0ec;
      padding: 3px 8px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 18px;
      white-space: nowrap;
      z-index: 3;
    }

    #label1 { top: 675px; left: 630px; transform: rotate(-20); }
    #label2 { top: 300px; left: 900px; }
    #label3 { top: 900px; left: 810px; }
    #label4 { top: 410px; left: 1670px; }
    #label5 { top: 550px; left: 1010px; }

    .tank-container {
      position: relative;
      width: 300px;
      height: 500px;
      margin: 50px auto;
    }

    /* Background image layer */
    /*.background-img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    } */

    /* Tank image layer */
.tank-container {
    width: 140px;
    height: 140px;
    margin: 50px auto;
    position: absolute;
    pointer-events: none;
}

.tank-img {
    top: -72px;
    left: -52px;
    width: 250px;
    height: 510px;
    z-index: 1;
    pointer-events: none;
    opacity: 0.8;
}

.liquid-container {
    width: 90px;
    height: 90%;  /* Changed from 70% */
    left: 20px;
    z-index: 3;
    overflow: hidden;
}

.liquid {
    position: absolute;
    bottom: 0;
    width: 90px;
    height: 0;  /* Start with 0 height */
    left: 20px;
    background: #0099ff;
    transition: height 1s ease-in-out;
    border-radius: 0 0 60px 60px / 0 0 32px 32px;
    opacity: 0.6;
    z-index: 3;
}

.liquid::before {
    content: "";
    position: absolute;
    bottom: 0;  /* Changed from top */
    left: 0;
    width: 100%;
    height: 40px;
    background: #bab9b9;
    border-radius: 0 0 300px 300px/ 0 0 128px 128px;
    z-index: 2;
    opacity: 1;
}

.wave {
    position: absolute;
    bottom: 0;  /* Changed from top */
    width: 120px;
    height: 16px;
    background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 120 20" xmlns="http://www.w3.org/2000/svg"><path d="M0 10 Q 30 0 60 10 T 120 10 V20 H0 Z" fill="%23ffffff"/></svg>') repeat-x;
    background-size: 48px 100%;
    animation: waveFlow 4s linear infinite;
    opacity: 0.3;
    z-index: 2;
    border-radius: 0 0 300px 300px/ 0 0 128px 128px;
}

.wave.wave2 {
    animation-duration: 6s;
    opacity: 0.2;
    bottom: 2px;  /* Changed from top */
}

@keyframes waveFlow {
    0% {
        background-position-x: 0;
    }
    100% {
        background-position-x: -48px;  /* Adjusted for thinner width */
    }
}
  </style>
</head>
<body>
<header>
    <h1>ðŸš› Diesel Plant Simulation</h1>
  </header>

  <div class="container">
    <!-- Plant Cards -->
    <div class="card" id="refinery"><img src ="..\source\RefinerySimple.jpg" alt = "RefinerySimple Image"></div>
    <div class="card-label">Refinery</div>
    <div class="card" id="terminal" onclick="openModal('Terminal')"><div class="tank-container">
    <div class="liquid-container">
        <div class="liquid" id="liquid">
            <div class="wave wave1"></div>
            <div class="wave wave2"></div>
        </div>
    </div>
    <img src="tt.webp" alt="Tank" class="tank-img">
</div><img src ="..\source\OilTankSimple.jpg" alt = "Oil Tank Image Image"><span class="percentage-overlay">75%</span></div>
    <div class="card-label">Terminal</div>
    <div class="card" id="local-storage" onclick="openModal('Local Storage')">
      <div class="tank-container">
    <div class="liquid-container">
      <div class="liquid" id="liquid">
        <div class="wave wave1"></div>
        <div class="wave wave2"></div>
      </div>
    </div>
    <img src="tt.webp" alt="Tank" class="tank-img">
    </div>
    <img src ="..\source\OilTankSimple.jpg" alt = "Oil Barrel Image"><span class="percentage-overlay">75%</span></div>
    <div class="card-label">Local Storage</div>
    <div class="card" id="inland-storage" onclick="openModal('Inland Storage')"><img src ="..\source\OilTankSimple.jpg" alt = "Oil Barrel Image"><span class="percentage-overlay">75%</span></div>
    <div class="card-label">Inland Storage</div>
    <div class="card" id="status"><h3>Status</h3><p>Monitoring...</p></div>
    <div class="card" id="local-demand" onclick="openModal('Local Demand')"><img src ="..\source\OtherOilPump.jpg" alt="Local Demand Image"><span class="percentage-overlay">80%</span></div>
    <div class="card-label">Local Demand</div>
    <div class="card" id="inland-demand" onclick="openModal('Inland Demand')"><img src ="..\source\OtherOilPump.jpg" alt="Inland Demand Image"><span class="percentage-overlay">65%</span></div>
    <div class="card-label">Inland Demand</div>




<!-- Spinner template -->
  <div id="spinner1" class="spinner-container">
    <label>Product Rate:</label><br>
    <input type="text" id="text1" readonly>
    <div class="buttons">
      <button onclick="scrollUp(0)">â–²</button>
      <button onclick="scrollDown(0)">â–¼</button>
    </div>
  </div>

  <div id="spinner2" class="spinner-container">
    <label>Storage Capacity:</label><br>
    <input type="text" id="text2" readonly>
    <div class="buttons">
      <button onclick="scrollUp(1)">â–²</button>
      <button onclick="scrollDown(1)">â–¼</button>
    </div>
  </div>

  <div id="spinner3" class="spinner-container">
    <label>Storage Capacity:</label><br>
    <input type="text" id="text3" readonly>
    <div class="buttons">
      <button onclick="scrollUp(2)">â–²</button>
      <button onclick="scrollDown(2)">â–¼</button>
    </div>
  </div>

  <div id="spinner4" class="spinner-container">
    <label>Storage Capacity:</label><br>
    <input type="text" id="text4" readonly>
    <div class="buttons">
      <button onclick="scrollUp(3)">â–²</button>
      <button onclick="scrollDown(3)">â–¼</button>
    </div>
  </div>

  <div id="spinner5" class="spinner-container">
    <label>Demand Rate:</label><br>
    <input type="text" id="text5" readonly>
    <div class="buttons">
      <button onclick="scrollUp(4)">â–²</button>
      <button onclick="scrollDown(4)">â–¼</button>
    </div>
  </div>

  <div id="spinner6" class="spinner-container">
    <label>Demand Rate:</label><br>
    <input type="text" id="text6" readonly>
    <div class="buttons">
      <button onclick="scrollUp(5)">â–²</button>
      <button onclick="scrollDown(5)">â–¼</button>
    </div>
  </div>

    <!-- Pipes -->
    <div class="pipe" id="pipe1"></div> 
    <div class="pipe" id="pipe2"></div> 
    <div class="pipe" id="pipe3"></div> 
    <div class="pipe" id="pipe4"></div>
    <div class="pipe" id="pipe4"></div> 
    <div class="pipe" id="pipe5"></div> 

    <!-- Flow Labels -->
    <div class="flow-label" id="label1">Flow: 60%</div>
    <div class="flow-label" id="label2">Flow: 50%</div>
    <div class="flow-label" id="label3">Flow: 70%</div>
    <div class="flow-label" id="label4">Flow: 80%</div>
    <div class="flow-label" id="label5">Flow: 65%</div>

  </div>

  

  <script>


const options = [
      ["Shutdown", "Operational"], // Spinner 1
      ["20%", "40%", "60%", "80%", "100%"],        // Spinner 2
      ["20%", "40%", "60%", "80%", "100%"],            // Spinner 3
      ["20%", "40%", "60%", "80%", "100%"],             // Spinner 4
      ["Low", "Medium", "High"], // Spinner 5
      ["Low", "Medium", "High"]  // Spinner 6
    ];

    const indices = [0, 0, 0, 0, 0, 0];

    function updateDisplay(i) {
      document.getElementById('text' + (i + 1)).value = options[i][indices[i]];
    }

    function scrollUp(i) {
      indices[i] = (indices[i] - 1 + options[i].length) % options[i].length;
      updateDisplay(i);
    }

    function scrollDown(i) {
      indices[i] = (indices[i] + 1) % options[i].length;
      updateDisplay(i);
    }

    // Initialize all spinners on page load
    window.onload = () => {
      for (let i = 0; i < options.length; i++) {
        updateDisplay(i);
      }
    };

//    const options = {
//      "Refinery": ["Shutdown", "Operational"],
//      "Terminal": ["0 tanks out", "1 tanks out","2 tanks out", "3 tanks out", "4 tanks out"],
//      "Local Storage": ["None", "Full"],
//      "Inland Storage": ["0 tanks out", "1 tanks out","2 tanks out", "3 tanks out"]
//    };

    const cardGlowMap = {
      "Refinery": ["glow-red", "glow-green"],
      "Terminal": ["glow-yellow", "glow-blue"],
      "Local Storage": ["glow-red", "glow-green"],
      "Inland Storage": ["glow-blue", "glow-green"]
    };

    function applySelection() {
      const selected = modalSelect.value;
      if (selected) {
        const card = document.getElementById(currentCard.toLowerCase().replace(" ", "-"));
        card.classList.remove("glow-red", "glow-green", "glow-blue", "glow-yellow");

        if (selected.includes("Operational") || selected.includes("Full") || selected.includes("High")) {
          card.classList.add(cardGlowMap[currentCard][1]);
        } else {
          card.classList.add(cardGlowMap[currentCard][0]);
        }

        alert(`${currentCard}, set to: ${selected}`);
        modal.style.display = "none";
      } else {
        alert("Please select an option.");
      }
    }

    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    };

    options["Local Demand"] = ["Low", "Medium", "High"];
    options["Inland Demand"] = ["Low", "Medium", "High"];


cardGlowMap["Local Demand"] = ["glow-yellow", "glow-green"];
cardGlowMap["Inland Demand"] = ["glow-yellow", "glow-green"];


    // Simulated flow updates
function updateFlowLabels() {
  const maxFlowRate = 100; // You can customize this value per pipe if needed

  const percent1 = 40 + Math.floor(Math.random() * 40); // 40â€“79%
  const percent2 = 30 + Math.floor(Math.random() * 50); // 30â€“79%
  const percent3 = 50 + Math.floor(Math.random() * 30); // 50â€“79%
  const percent4 = 50 + Math.floor(Math.random() * 30);
  const percent5 = 50 + Math.floor(Math.random() * 30);

  const flow1 = ((percent1 / 100) * maxFlowRate).toFixed(1);
  const flow2 = ((percent2 / 100) * maxFlowRate).toFixed(1);
  const flow3 = ((percent3 / 100) * maxFlowRate).toFixed(1);
  const flow4 = ((percent4 / 100) * maxFlowRate).toFixed(1);
  const flow5 = ((percent5 / 100) * maxFlowRate).toFixed(1);

  document.getElementById("label1").textContent = `Flow: ${flow1} kL/h`;
  document.getElementById("label2").textContent = `Flow: ${flow2} kL/h`;
  document.getElementById("label3").textContent = `Flow: ${flow3} kL/h`;
  document.getElementById("label4").textContent = `Flow: ${flow4} kL/h`;
  document.getElementById("label5").textContent = `Flow: ${flow5} kL/h`;
}

setInterval(updateFlowLabels, 2000);


function setFlowSpeed(pipeId, labelId, percent) {
  const pipe = document.getElementById(pipeId);
  const label = document.getElementById(labelId);

  // Normalize speed (higher percentage = faster flow)
  const minDuration = 0.5;
  const maxDuration = 2.5;
  const duration = maxDuration - (percent / 100) * (maxDuration - minDuration);
  pipe.style.setProperty('--flow-speed', `${duration}s`);

  // Convert percentage to flow rate (in kiloliters per hour)
  const maxFlowRate = 100; // Max flow rate in kL/h
  const flowRate = ((percent / 100) * maxFlowRate).toFixed(1); // round to 1 decimal

  // Update label with kL/h instead of percentage
  label.innerText = `Flow: ${flowRate} kL/h`;
}

// Set initial flow speeds
setFlowSpeed("pipe1", "label1", 60);
setFlowSpeed("pipe2", "label2", 50);
setFlowSpeed("pipe3", "label3", 70);
setFlowSpeed("pipe4", "label4", 80); 
setFlowSpeed("pipe5", "label5", 65);

  const liquid = document.getElementById('liquid');
let percentage = 20;

function increaseLiquid() {
    if (percentage > 100) return;
    liquid.style.height = percentage + '%';
    percentage += 20;
    setTimeout(increaseLiquid, 2000);
}

window.onload = increaseLiquid;

  </script>

</body>
</html>
